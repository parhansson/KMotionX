<!DOCTYPE html>
<html>
<head>

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>


<meta name="keywords" content="ethernet 16-axis controller, cnc control, motion control, cnc boards, 4-axis, 8-axis, stepper, brushless, DC motor, servo, encoder, adc, dac, motion controller, automated motion, manufacturing, Mach3">
<meta name="description" content="Manufacturer of premium motion control products for CNC Manufacturing, Robotics and Automation">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Language" content="en-us">
<title>MCodes with Parameters</title>

<link rel="stylesheet" type="text/css" href="../css/style.css">
<link rel="stylesheet" href="../css/prism.css" data-noprefix />
<script src="../js/prism.js"></script>
</head>

<body>

<div id="logo"><a href="../index.htm"></a></div>

<div id="home">
<a href="../index.htm">Table of contents</a> |  
	<script>
		if (navigator.userAgent.indexOf("NT 6.2") == -1){
			document.write('<a href="https://www.dynomotion.com">Dynomotion home page</a>')
		} else {
			document.write('<a href="https://www.dynomotion.com" target="_blank">Dynomotion home page</a>')
		}
	</script>
</div>
	
<div id="searchNav">

	<div class="gcse-search">
					<script>
					  if (document.location.protocol  ==  'https:') {
					  (function() {
					  var cx = '012657033059195044748:9fmjmlufts0';
					  var gcse = document.createElement('script');
					  gcse.type = 'text/javascript';
					  gcse.async = true;
					  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					      '//cse.google.com/cse.js?cx=' + cx;
					  var s = document.getElementsByTagName('script')[0];
					  s.parentNode.insertBefore(gcse, s);
					})();
					  }
				      </script> 
				      <gcse:search> </gcse:search>  

	       </div>
</div>	

	


<div id="google_translate_element" style="background: transparent;" align="right"><script type="text/javascript">
if (navigator.userAgent.indexOf("NT 6.2") == -1) {
		function googleTranslateElementInit() {
	  new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'en,de,fr,it,es,pt,ru,uk,ar,zh-CN,zh-TW,ko,iw,hi,ja,tr', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
		}						}
	</script>
	<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit">
	</script>
</div>		
<div id="main">

<h1>MCodes with Parameters</h1>

<p>KMotionCNC allows MCodes 100-119 with parameters when 
configured to Execute a KFLOP User C Program. The P Q and R words in the 
GCode block will be downloaded to KFLOP's persist.UserData variables before the 
C program is executed. The parameters will be placed into consecutive 
KFLOP variables as 32-bit floating point values starting with the variable 
specified in the MCode Configuration. Zero, one, two, or all three 
parameters may be specified in the GCode block (line). The order they are 
placed into the variables will always be in the P Q R order where any or all of 
the parameters will be omitted if they are not explicitly specified in the GCode 
Block. If no parameters are specified then the MCode number will be stored 
into the one Var specified.</p>

<h2>Example MCode Configuration</h2>

<p><img src="KMotionCNCfiles/MCodeConfig.png" width="981" height="30" alt="Example MCode" /></p>

<h2>Example MCode Usage with all 3 parameters:</h2>

<p>M110 P1.23 Q4.56 R-1</p>

<h2>Example C Code accessing parameters:</h2>

<pre>
	<code class="language-c">
	#include &quot;KMotionDef.h&quot;
	
	main()
	{

		printf(&quot;P = %f Q = %f R = %f\n&quot;,
			*(float *)&amp;persist.UserData[0],
			*(float *)&amp;persist.UserData[1],
			*(float *)&amp;persist.UserData[2]);
	}
	</code>
</pre>


<h2>Printed Result</h2>

<p>P = 1.230000 Q = 4.560000 R = -1.000000</p>


<p></p>
	</div>
	
</body>

</html>
