<!DOCTYPE html>

<html>

<head>



<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>

<meta http-equiv="Pragma" content="no-cache"/>

<meta http-equiv="Expires" content="0"/>





<meta name="keywords" content="ethernet 16-axis controller, cnc control, motion control, cnc boards, 4-axis, 8-axis, stepper, brushless, DC motor, servo, encoder, adc, dac, motion controller, automated motion, manufacturing, Mach3">

<meta name="description" content="Manufacturer of premium motion control products for CNC Manufacturing, Robotics and Automation">

<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<meta http-equiv="Content-Language" content="en-us">

<title>KMotionCNC Fiducial Alignment</title>



<link rel="stylesheet" type="text/css" href="../css/style.css">

<link rel="stylesheet" href="../css/prism.css" data-noprefix />

<script src="../js/prism.js"></script>

</head>



<body>



<div id="logo"><a href="../index.htm"></a></div>

<div id="home">
<a href="../index.htm">Table of contents</a> |  
	<script>
		if (navigator.userAgent.indexOf("NT 6.2") == -1){
			document.write('<a href="https://www.dynomotion.com">Dynomotion home page</a>')
		} else {
			document.write('<a href="https://www.dynomotion.com" target="_blank">Dynomotion home page</a>')
		}
	</script>
</div>
	
<div id="searchNav">

	<div class="gcse-search">
					<script>
					  if (document.location.protocol  ==  'https:') {
					  (function() {
					  var cx = '012657033059195044748:9fmjmlufts0';
					  var gcse = document.createElement('script');
					  gcse.type = 'text/javascript';
					  gcse.async = true;
					  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					      '//cse.google.com/cse.js?cx=' + cx;
					  var s = document.getElementsByTagName('script')[0];
					  s.parentNode.insertBefore(gcse, s);
					})();
					  }
				      </script> 
				      <gcse:search> </gcse:search>  

	       </div>
</div>	

	


<div id="google_translate_element" style="background: transparent;" align="right"><script type="text/javascript">
if (navigator.userAgent.indexOf("NT 6.2") == -1) {
		function googleTranslateElementInit() {
	  new google.translate.TranslateElement({pageLanguage: 'en', includedLanguages: 'en,de,fr,it,es,pt,ru,uk,ar,zh-CN,zh-TW,ko,iw,hi,ja,tr', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
		}						}
	</script>
	<script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit">
	</script>
</div>		
<div id="main">

	

<h1>KMotionCNC Fiducial Alignment</h1>



<p>Fiducial Alignment using the external example C# 

program first added in KMotion Version 4.33l and located at &lt;Install&gt;\PC VCS Example\MeasureFiducials.</p>



<p><img src="KMotionCNCfiles/FiducialAlignScreen.png" width="565" height="381" alt="Fiducial Alignment Screen" /></p>



<p>See <a href="https://www.youtube.com/embed/a_p38zktIZI">video:</a></p>



<iframe width="560" height="315" src="https://www.youtube.com/embed/a_p38zktIZI" frameborder="0" allowfullscreen></iframe>



<p>Measure Fiducials creates and overwrites the

<a href="GeoCorrection.htm">Geometric Correction</a> file named:</p>



<p>&lt;Install Directory&gt;\KMotion\Data\FiducialsMap.txt</p>

<p>This should be configured for KMotionCNC to use in the

<a href="ToolSetupScreenFiles.htm">KMotionCNC | Tool Setup | Tool Setup Files 

configuration page</a> as shown here:</p>



<p><img src="KMotionCNCfiles/ToolSetupGeo.png" width="1099" height="504" alt="Tool Setup" /></p>



<p>The created Geometric Correction File of 2x2 grid points 

in the form shown below. The table maps the corrected locations of a 

simple 1x1 inch square centered on the origin. Note that because the the 

Geo Correction Transformation extends outside the Grid using the closest Grid's 

Transformation the size and location of the square is not important.</p>



<pre>

	2,2

	1,1

	-0.5,-0.5

	0,0,-0.411272,-0.508541,0

	0,1,0.598128,-0.507930,0

	1,0,-0.411883,0.500859,0

	1,1,0.597517,0.501470,0

</pre>



<p>The Measure Fiducials App loads Settings from a file named :</p>



<p><strong>&lt;Install&gt;\PC VCS Examples\MeasureFiducials\MeasureFiducialSettings.txt</strong></p>



<p>Which has this fixed format (avoid extra spaces or tabs). JogSpeed controls the Jog 

button speeds in counts/inch for both x and y. Resolution should be set to 

the same value as in KMotionCNC in counts/inch. If your system has more 

than one Video Capture Device you can control which is selected with the 

VideoDevice parameter. Zero would be the first detected. MouseMag 

adjusts the scale factor between Mouse movement and Axes movement. </p>



<pre>

	JogSpeed 600

	Resolution 10000 10000

	VideoDevice 0

	MouseMag 0.25

</pre>



<p>KMotionCNC accepts a Window Event to Re-load the current Geometric Correction File. The C# 

Measure Fiducials Example finds any open KMotionCNC Window with:</p>





<pre>

	<code class="language-c">

	[DllImport(&quot;User32.dll&quot;, SetLastError = true)]

	public static extern IntPtr FindWindow(String lpClassName, String lpWindowName);

	

	IntPtr KMotionCNCWindow = FindWindow(&quot;KMotionCNC&quot;, null);

	

	and sends the Window Event to KMotionCNC with:

	

	[return: MarshalAs(UnmanagedType.Bool)]

	[DllImport(&quot;user32.dll&quot;, SetLastError = true)]

	public static extern bool PostMessage(IntPtr hWnd, uint Msg, int wParam, int lParam);

	

	uint WM_COMMAND = 0x0111;

	int ID_ReloadGeoCorrection = 33016;

	PostMessage(KMotionCNCWindow, WM_COMMAND, ID_ReloadGeoCorrection, 0);

	</code>

</pre>



<p>&nbsp;</p>



	</div>

</body>



</html>

