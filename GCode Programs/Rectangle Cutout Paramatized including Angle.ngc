(------PARAMETERS RECTANGULAR HOLE CUTTING----------------------------)
 
#1=5  (#1= Select a subroutine)
(1 CW  CutInside)
(2 CW  CutOutside)
(3 CCW CutInside)
(4 CCW CutOutside)
(5 CW  Cut and pocket inside)
 
#2=300                (Width  X-X)
#3=250               (Height Y-Y)
#4=5                 (Tool diameter)
#5=5                (Distance between cut layers)
#6=12                (No. of layers to cut)
#7=10000              (Feed rate in metres/min)
#8=0                 (<Spare>)
#9=10                (Start cutting at Z height = ?)
#10=10                (% Crossover if pocketing)
#11=45                (Rotational transformation angle CCW)     
 
( X[xcos[#11] - ysin[#11]  Y[xsin[#11] + ycos[#11] )
(----------------------------------)
F[#7]
g0 g21 g90 g17 g40 g49 g80				(Metric, Absolute, XY Plane, Cancel Cutter Comp, Cancel Tool length Comp, Cancel Canned)
#81=0                                                                                    (Which way to retract from bottom)
#10=[1-[#10/100]+0.0001]				(Prevent divide by zero error at 100%)
#20=[#10*#4]							(Actual stepover amount)
 
G90 G1 X0  Y0  Z[#9*1.5]				(Starting height)
M98 P1 L100000							(Loop forever until Halted - same as Do While)
O1
M98 P11  L[#1=1]
M98 P111 L[#1=1]
M98 P12  L[#1=2]
M98 P112 L[#1=2]
M98 P13  L[#1=3]
M98 P113 L[#1=3]
M98 P14  L[#1=4]
M98 P114 L[#1=4]
M98 P15  L[#1=5] (---Pocket---)

M98 P2
(----------------------------------------------------------------------)
(----------------------------------------------------------------------)
O11(CCW INSIDE)
G90 G1 X[-[#4/2]*sin[#11]]    Y [[#4/2]*cos[#11]] 
G1Z[#9]
M98 P101 L[#6-1]
O101  (CCW INSIDE ramping)
(-----------------------------------)
G91
G1 X[[#2-#4]*cos[#11] ]    Y[[#2-#4]*sin[#11]]   Z[-#5/4]
G1 X[-[#3-#4]*sin[#11]]    Y[[#3-#4]*cos[#11]]   Z[-#5/4]
G1 X[[-#2+#4]*cos[#11]]    Y[[-#2+#4]*sin[#11]]  Z[-#5/4]
G1 X[-[-#3+#4]*sin[#11]]   Y[[-#3+#4]*cos[#11]]  Z[-#5/4]
M99
(-----------------------------------)
O111  (CCW INSIDE Flat M98 P111 L[#1=1])                         
G1   X[[#2-#4]*cos[#11]]    Y[[#2-#4]*sin[#11]]
G1   X[-[#3-#4]*sin[#11]]   Y[[#3-#4]*cos[#11]]
G1   X[[-#2+#4]*cos[#11]]   Y[[-#2+#4]*sin[#11]]
G1   X[-[-#3+#4]*sin[#11]]  Y[[-#3+#4]*cos[#11]]
M98 P2
M99
(----------------------------------------------------------------------)
O12(CCW OUTSIDE)
G90 G1 X[-#4/2] Y[-#4/2]
G1Z[#9]
M98 P102 L[#6-1]
O102  (CCW OUTSIDE ramping)
(-----------------------------------)
G91
G1 X[[#2+#4]*cos[#11]]    Y[[#2+#4]*sin[#11]]   Z[-#5/4]
G1 X[-[#3+#4]*sin[#11]]    Y[[#3+#4]*cos[#11]]   Z[-#5/4]
G1 X[[-#2-#4]*cos[#11]]    Y[[-#2-#4]*sin[#11]]   Z[-#5/4]
G1 X[-[-#3-#4]*sin[#11]]    Y[[-#3-#4]*cos[#11]]    Z[-#5/4]
M99
(-----------------------------------)
O112  (CCW OUTSIDE Flat M98 P111 L[#1=2])
(CCW OUTSIDE flat)
G1   X[[#2+#4]*cos[#11]]   Y[[#2+#4]*sin[#11]]
G1   X[-[#3+#4]*sin[#11]]    Y[[#3+#4]*cos[#11]]
G1   X[[-#2-#4]*cos[#11]]   Y[[-#2-#4]*sin[#11]]
G1   X[-[-#3-#4]*sin[#11]]   Y[[-#3-#4]*cos[#11]]
M98 P2
M99
(----------------------------------------------------------------------)
(----------------------------------------------------------------------)
O13(CW INSIDE)
G90 G1 X[[[#4/2]*cos[#11]] - [#4/2]*sin[#11]]  Y[[[#4/2]*sin[#11]] + [[#4/2]*cos[#11]]]
G1Z[#9]
M98 P103 L[#6-1]
O103   (CW INSIDE ramping)
(-----------------------------------)
G91
G1  X  [-[#3-#4]*sin[#11]]    Y [[#3-#4]*cos[#11]]   Z[-#5/4]
G1  X  [[#2-#4]*cos[#11]]     Y [[#2-#4]*sin[#11]]   Z[-#5/4]
G1  X  [-[-#3+#4]*sin[#11]]   Y [[-#3+#4]*cos[#11]]  Z[-#5/4]
G1  X  [[-#2+#4]*cos[#11]]    Y [[-#2+#4]*sin[#11]]  Z[-#5/4]
M99
(-----------------------------------)
O113  (CW INSIDE Flat M98 P111 L[#1=3])
(CCW INSIDE flat)
G1  X  [-[#3-#4]*sin[#11]]    Y [[#3-#4]*cos[#11]]
G1  X  [[#2-#4]*cos[#11]]     Y [[#2-#4]*sin[#11]] 
G1  X  [-[-#3+#4]*sin[#11]]   Y [[-#3+#4]*cos[#11]] 
G1  X  [[-#2+#4]*cos[#11]]    Y [[-#2+#4]*sin[#11]]
M98 P3
M99
(----------------------------------------------------------------------)
O14(CW OUTSIDE)
G90 G1 X[-#4/2] Y[-#4/2]
G1Z[#9]
M98 P104 L[#6-1]
O104   (CW OUTSIDE ramping)
(-----------------------------------)
G91
G1  X [-[#3+#4]*sin[#11]]             Y [[#3+#4]*cos[#11]]   Z[-#5/4]
G1  X [[#2+#4]*cos[#11]]              Y [[#2+#4]*sin[#11]]   Z[-#5/4]
G1  X [-[-#3-#4]*sin[#11]]             Y [[-#3-#4]*cos[#11]]  Z[-#5/4]
G1  X [[-#2-#4]*cos[#11]]             Y [[-#2-#4]*sin[#11]] Z[-#5/4]
M99
(-----------------------------------)
O114
(CW OUTSIDE flat)
G1  X [-[#3+#4]*sin[#11]]    Y [[#3+#4]*cos[#11]]
G1  X [[#2+#4]*cos[#11]]     Y [[#2+#4]*sin[#11]]
G1  X [-[-#3-#4]*sin[#11]]   Y [[-#3-#4]*cos[#11]]
G1  X [[-#2-#4]*cos[#11]]    Y [[-#2-#4]*sin[#11]]
M98 P3
M99
(----------------------------------------------------------------------)
(----------------------------------------------------------------------)
O15(CW INSIDE POCKETING)
G1Z[#9]
M98 P18  L1
M98 P105 L1
(----------------------------------------------------------------------)
O18(CCW INSIDE)
G91 G1 X[-[#4/2]*sin[#11]]    Y [[#4/2]*cos[#11]] 
(-----------------------------------) 
M98 P108 L[#6-1]		(CCW INSIDE ramping)
O108  
G91
G1 X[[#2-#4]*cos[#11] ]		Y[[#2-#4]*sin[#11]]		Z[-#5/4]
G1 X[-[#3-#4]*sin[#11]]		Y[[#3-#4]*cos[#11]]		Z[-#5/4]
G1 X[[-#2+#4]*cos[#11]]		Y[[-#2+#4]*sin[#11]]	Z[-#5/4]
G1 X[-[-#3+#4]*sin[#11]]	Y[[-#3+#4]*cos[#11]]	Z[-#5/4]
M99
(-----------------------------------)
O105(CW INSIDE POCKETING)
#2=[#2-#4]	(Ensure cutting inside of required dimensions)
#3=[#3-#4]	(Ensure cutting inside of required dimensions)

G1  X[#2*cos[#11]]		Y[#2*sin[#11]]
G1  X[-#3*sin[#11]]		Y[#3*cos[#11]]
G1  X[-#2*cos[#11]]		Y[-#2*sin[#11]]
G1  X[#3*sin[#11]]		Y[-#3*cos[#11]]
G1  X[#20*cos[#11] - #20*sin[#11]]      Y[#20*sin[#11] + #20*cos[#11]]

#30=[#2-#20*2]
#31=[#3-#20*2]

G1  X[[#30+0*#20]*cos[#11]]   Y[[#30+0*#20]*sin[#11]]  
G1  X[-[#31-0*#20]*sin[#11]]  Y[[#31-0*#20]*cos[#11]] 
G1  X[[-#30+0*#20]*cos[#11]]  Y[[-#30+0*#20]*sin[#11]]

#21=1
M98 P66 L10000

O66
#22=[-#31+#21*#20]
#23=[#30-#21*#20]
#24=[#31-[#21+1]*#20]
#25=[-#30+[#21+1]*#20]

m98 P45 L[#22>0]
G1 X -[#22*sin[#11]]  Y[#22*cos[#11]]
m98 P45 L[#23<0]
G1 X[[#23]*cos[#11]]  Y[[#23]*sin[#11]]
m98 P45 L[#24<0]
G1 X[-#24*sin[#11]]  Y[#24*cos[#11]]
m98 P45 L[#25>0]
G1 X[#25*cos[#11]]  Y[#25*sin[#11]]

#21=[#21+2]

M99

O45
M30

(--------------------------------End of subs-----------------------------)
O2 (CW finish off)
G1 X[[ 0.5*#2]*cos[#11]]    Y[[ 0.5*#2]*sin[#11]]  Z[#5*[#6-1]]
G1 X[[-0.5*#2]*cos[#11]]    Y[[-0.5*#2]*sin[#11]]  Z[#5*[#6-1]]
M30
(-----------------------------------)
O3 (CCW finish off)
G1 X[-[0.5*#3]*sin[#11]]    Y[[0.5*#3]*cos[#11]]  Z[#5*[#6-1]]
G1 X[[-0.5*#3]*sin[#11]]    Y[[[-0.5*#3]*cos[#11]]] Z[#5*[#6-1]] M30





